<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head th:replace="fragments :: head"></head>

<body>

    <h1 th:href="@{/css/techjobs.css}">Welcome, Shipping and Payment!</h1>

    <div th:replace="fragments :: page-header"></div>

    <form method="post" th:href="@{/checkout}">
        <div>
            <div class="shopping-item a">
                <h2 class="shippingaddress">Shipping Address</h2>
                <div>
                    <div class="val-wrap first">First Name
                        <div>
                            <input type="text" th:field="${shippingAndPayment.firstname}" class="csv firstnamebox"/>
                        </div>
                        <div>
                            <p class="error shipping" th:errors="${shippingAndPayment.firstname}"></p>
                        </div>
                    </div>
                    <div class="val-wrap first">Last Name
                        <div>
                            <input type="text" th:field="${shippingAndPayment.lastname}" class="csv firstnamebox"/>
                        </div>
                        <div>
                        <p class="error shipping" th:errors="${shippingAndPayment.lastname}"></p>
                        </div>
                    </div>
                    <div class="val-wrap first">Street Address
                        <div>
                            <input type="text" th:field="${shippingAndPayment.streetaddress}" class="csv firstnamebox"/>
                        </div>
                        <div>
                            <p class="error shipping" th:errors="${shippingAndPayment.streetaddress}"></p>
                        </div>
                    </div>
                    <div class="val-wrap first">City
                        <div>
                            <input type="text" th:field="${shippingAndPayment.city}" class="csv firstnamebox"/>
                        </div>
                        <div>
                            <p class="error shipping" th:errors="${shippingAndPayment.city}"></p>
                        </div>
                    </div>
                    <div class="val-wrap first">State
                        <div>
                            <table>
                                <tr>
                                    <td>
                                        <select class="csv country" name="state">
                                            <option value="">Select</option>
                                            <option value="AL">Alabama</option>
                                            <option value="AK">Alaska</option>
                                            <option value="AZ">Arizona</option>
                                            <option value="AR">Arkansas</option>
                                            <option value="CA">California</option>
                                            <option value="CO">Colorado</option>
                                            <option value="CT">Connecticut</option>
                                            <option value="DE">Delaware</option>
                                            <option value="DC">District Of Columbia</option>
                                            <option value="FL">Florida</option>
                                            <option value="GA">Georgia</option>
                                            <option value="HI">Hawaii</option>
                                            <option value="ID">Idaho</option>
                                            <option value="IL">Illinois</option>
                                            <option value="IN">Indiana</option>
                                            <option value="IA">Iowa</option>
                                            <option value="KS">Kansas</option>
                                            <option value="KY">Kentucky</option>
                                            <option value="LA">Louisiana</option>
                                            <option value="ME">Maine</option>
                                            <option value="MD">Maryland</option>
                                            <option value="MA">Massachusetts</option>
                                            <option value="MI">Michigan</option>
                                            <option value="MN">Minnesota</option>
                                            <option value="MS">Mississippi</option>
                                            <option value="MO">Missouri</option>
                                            <option value="MT">Montana</option>
                                            <option value="NE">Nebraska</option>
                                            <option value="NV">Nevada</option>
                                            <option value="NH">New Hampshire</option>
                                            <option value="NJ">New Jersey</option>
                                            <option value="NM">New Mexico</option>
                                            <option value="NY">New York</option>
                                            <option value="NC">North Carolina</option>
                                            <option value="ND">North Dakota</option>
                                            <option value="OH">Ohio</option>
                                            <option value="OK">Oklahoma</option>
                                            <option value="OR">Oregon</option>
                                            <option value="PA">Pennsylvania</option>
                                            <option value="RI">Rhode Island</option>
                                            <option value="SC">South Carolina</option>
                                            <option value="SD">South Dakota</option>
                                            <option value="TN">Tennessee</option>
                                            <option value="TX">Texas</option>
                                            <option value="UT">Utah</option>
                                            <option value="VT">Vermont</option>
                                            <option value="VA">Virginia</option>
                                            <option value="WA">Washington</option>
                                            <option value="WV">West Virginia</option>
                                            <option value="WI">Wisconsin</option>
                                            <option value="WY">Wyoming</option>
                                        </select>
                                    </td>
                                    <td id="response">
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div>
                            <p class="error shipping" th:errors="${shippingAndPayment.state}"></p>
                        </div>
                    </div>
                    <div class="val-wrap first">Zip/Postal Code
                        <div>
                            <input type="text" th:field="${shippingAndPayment.zipcode}" data-exact="5" class="csv firstnamebox"/>
                        </div>
                        <div>
                            <p class="error shipping" th:errors="${shippingAndPayment.zipcode}"></p>
                        </div>
                    </div>
                    <div class="val-wrap first">Phone Number
                        <div>
                            <input type="text" th:field="${shippingAndPayment.phonenumber}" data-exact="10" class="csv firstnamebox"/>
                        </div>
                        <div>
                            <p class="error shipping" th:errors="${shippingAndPayment.phonenumber}"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="shopping-item b">
                <h2 class="paymentmethod">Payment Method</h2>
                <div>
                    <p><input type="checkbox" class="csv creditcardaddress a"> My billing and shipping address are the same</p>
                    <div id="result">
                        <textarea type="text" name="creditcardaddress" class="csv creditcardaddressbox" id="creditcardaddressinput" rows="6" cols="10"></textarea>
                    </div>
                    <div class="val-wrap creditcardtype">Credit Card Number
                        <div>
                            <input type="text" th:field="${shippingAndPayment.creditcardnumber}" data-exact="16" class="csv creditcardnumberbox"/>
                        </div>
                        <div>
                            <p class="error creditcardnumber" th:errors="${shippingAndPayment.creditcardnumber}"></p>
                        </div>
                    </div>
                    <div class="expirationdate">Expiration Date</div>
                        <div class="val-wrap expiration a">
                            <div>
                                <table>
                                    <tr>
                                        <td>
                                            <select name="expirationmonth" class="csv month">
                                                <option value="">Month</option>
                                                <option value="January">January</option>
                                                <option value="Febuary">Febuary</option>
                                                <option value="March">March</option>
                                                <option value="April">April</option>
                                                <option value="May">May</option>
                                                <option value="June">June</option>
                                                <option value="July">July</option>
                                                <option value="August">August</option>
                                                <option value="September">September</option>
                                                <option value="October">October</option>
                                                <option value="November">November</option>
                                                <option value="December">December</option>
                                            </select>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div>
                                <p class="error creditcard" th:errors="${shippingAndPayment.expirationmonth}"></p>
                            </div>
                        </div>
                        <div class="val-wrap expiration b">
                            <div>
                                <table>
                                    <tr>
                                        <td>
                                            <select name="expirationyear" class="csv year">
                                                <option value="">Year</option>
                                                <option value="2020">2020</option>
                                                <option value="2021">2021</option>
                                                <option value="2022">2022</option>
                                                <option value="2023">2023</option>
                                                <option value="2024">2024</option>
                                                <option value="2025">2025</option>
                                                <option value="2026">2026</option>
                                                <option value="2027">2027</option>
                                                <option value="2028">2028</option>
                                                <option value="2029">2029</option>
                                                <option value="2030">2030</option>
                                            </select>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div>
                                <p class="error creditcard-year" th:errors="${shippingAndPayment.expirationyear}"></p>
                            </div>
                        </div>
                    <div class="val-wrap">
                        <div class="creditcardtype">Card Verification Number</div>
                        <input type="text" th:field="${shippingAndPayment.cardverificationnumber}" data-exact="3" class="csv cardverificationnumberbox"/>
                        <p class="error creditcard" th:errors="${shippingAndPayment.cardverificationnumber}"></p>
                    </div>
                </div>
            </div>
            <div class="submit-placeorder">
                <input type="submit" class="btn-primary-placeorder" value="Place Order" />
            </div>
        </div>
    </form>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script>
function toggleValidationMsg(evt) {
    var tgt = evt.target;
    var exactLength = $(evt.target).data("exact")
    var pVal = $(evt.target).closest(".val-wrap").find("p.error")

    if (exactLength != null) {
        if (tgt.value.length == exactLength) {
            pVal.hide()
        } else {
            pVal.show()
        }
    }
    else {
        if (tgt.value.length > 0) {
            pVal.hide()
        } else {
            pVal.show()
        }
    }
}

$(document).ready(function() {
    //Hide/show validation messages for any input with csv class wrapped in a div val-wrap containing p with error class.
    $(".csv").keyup(toggleValidationMsg);
    $(".csv").mouseup(toggleValidationMsg);
});

$('input[type="checkbox"]').click(function(){
    if($(this).is(":checked")){
        $(".creditcardaddressbox")[0].value = $("#firstname")[0].value + " " + $("#lastname")[0].value + " " + "\n" +
                                              $("#streetaddress")[0].value + " " + "\n" +
                                              $("#city")[0].value + "," + " " +
                                              $("select[name=state]").val() + "\n" +
                                              $("#zipcode")[0].value
    }
    else if($(this).is(":not(:checked)")){
        $(".creditcardaddressbox")[0].value = "First Name:" + "\n" + "Last Name:" + "\n" +
                                              "Street Address:" + "\n" + "City:" + "\n" +
                                              "State:" + "\n" + "Zip/Postal Code:" + "\n"
    }
});
</script>
</body>
</html>